<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ModMed Value Calculator</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root{--purple:#6B3FA0;--gold:#F5B335;--bg:#f5f5f7;--card:#fff;--text:#1a1a2e;--text2:#64748b;--muted:#94a3b8;--border:#e2e8f0;--red:#dc2626;--green:#16a34a;--blue:#2563eb;--orange:#ea580c}
        *{box-sizing:border-box;margin:0;padding:0}
        body{font-family:'Inter',sans-serif;background:var(--bg);color:var(--text);font-size:13px;line-height:1.5}
        
        .header{background:var(--purple);color:#fff;padding:12px 16px;position:sticky;top:0;z-index:100}
        .header-inner{max-width:960px;margin:0 auto;display:flex;justify-content:space-between;align-items:center}
        .logo{font-weight:700;font-size:15px;display:flex;align-items:center;gap:8px}
        .logo svg{width:28px;height:28px}
        .btns{display:flex;gap:6px}
        .btn{padding:8px 14px;border-radius:6px;font-size:11px;font-weight:600;border:none;cursor:pointer}
        .btn-light{background:rgba(255,255,255,.2);color:#fff}
        .btn-gold{background:var(--gold);color:#000}
        
        .main{max-width:960px;margin:0 auto;padding:16px}
        
        /* Step Container */
        .step{background:var(--card);border-radius:12px;margin-bottom:16px;overflow:hidden;border:1px solid var(--border)}
        .step-header{padding:14px 16px;background:linear-gradient(to right,#f8fafc,#fff);border-bottom:1px solid var(--border);display:flex;justify-content:space-between;align-items:center}
        .step-num{width:28px;height:28px;background:var(--purple);color:#fff;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:700;margin-right:10px}
        .step-title{font-size:14px;font-weight:700;display:flex;align-items:center}
        .step-subtitle{font-size:11px;color:var(--text2);margin-left:38px}
        .step-total{text-align:right}
        .step-total-label{font-size:10px;color:var(--muted);text-transform:uppercase}
        .step-total-value{font-size:20px;font-weight:700}
        .step-total-value.red{color:var(--red)}
        .step-total-value.green{color:var(--green)}
        .step-total-value.blue{color:var(--blue)}
        .step-body{padding:16px}
        
        /* Info Box */
        .info-box{background:#fffbeb;border:1px solid #fcd34d;border-radius:8px;padding:10px 12px;margin-bottom:14px;font-size:11px;color:#92400e}
        .info-box.blue{background:#eff6ff;border-color:#93c5fd;color:#1e40af}
        .info-box strong{font-weight:600}
        
        /* Input Grid */
        .input-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:12px}
        .input-box{display:flex;flex-direction:column;gap:3px}
        .input-box label{font-size:10px;font-weight:600;color:var(--text2);text-transform:uppercase}
        .input-box input,.input-box select{background:#f8fafc;border:1px solid var(--border);border-radius:6px;padding:10px 12px;font-size:14px;font-weight:600}
        .input-box input:focus,.input-box select:focus{outline:none;border-color:var(--purple);background:#fff}
        .input-box .hint{font-size:9px;color:var(--blue);margin-top:2px}
        
        /* Derived Stats */
        .derived-row{display:grid;grid-template-columns:repeat(4,1fr);gap:10px;margin-top:14px;padding-top:14px;border-top:1px dashed var(--border)}
        .derived-stat{text-align:center;padding:8px;background:#f8fafc;border-radius:6px}
        .derived-stat-label{font-size:9px;color:var(--muted);text-transform:uppercase}
        .derived-stat-value{font-size:16px;font-weight:700;margin-top:2px}
        
        /* Metric Table */
        .metric-table{width:100%;border-collapse:collapse}
        .metric-table th{font-size:10px;font-weight:600;color:var(--text2);text-transform:uppercase;padding:10px 8px;text-align:center;background:#f8fafc;border-bottom:1px solid var(--border)}
        .metric-table th:first-child{text-align:left;width:30%}
        .metric-table th.current{color:var(--red)}
        .metric-table th.modmed{color:var(--green)}
        .metric-table th.savings{color:var(--blue)}
        .metric-table td{padding:12px 8px;border-bottom:1px solid #f1f5f9;vertical-align:top}
        .metric-table td:first-child{text-align:left}
        .metric-table td:not(:first-child){text-align:center}
        .metric-table tr:last-child td{border-bottom:none}
        
        .metric-name{font-weight:600;font-size:13px}
        .metric-desc{font-size:10px;color:var(--text2);margin-top:2px}
        .metric-formula{font-size:9px;color:var(--muted);margin-top:4px;font-style:italic}
        
        .metric-input{width:70px;padding:8px;border:1px solid var(--border);border-radius:5px;font-size:13px;font-weight:600;text-align:center}
        .metric-input:focus{outline:none;border-color:var(--purple)}
        .metric-input.red{background:#fef2f2;border-color:#fecaca;color:var(--red)}
        .metric-input.green{background:#f0fdf4;border-color:#bbf7d0;color:var(--green)}
        
        .metric-cost{font-size:14px;font-weight:700;color:var(--red)}
        .metric-target{font-size:14px;font-weight:600;color:var(--green)}
        .metric-save{font-size:14px;font-weight:700;color:var(--blue)}
        
        /* Subtotal Row */
        .subtotal-row{background:#f8fafc;border-top:2px solid var(--border)}
        .subtotal-row td{padding:14px 8px;font-weight:700}
        .subtotal-row .metric-name{font-size:12px;text-transform:uppercase;color:var(--text2)}
        
        /* Summary Cards */
        .summary-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:12px}
        .summary-card{text-align:center;padding:16px 10px;border-radius:10px}
        .summary-card.pain{background:linear-gradient(135deg,#fef2f2,#fee2e2);border:1px solid #fecaca}
        .summary-card.save{background:linear-gradient(135deg,#f0fdf4,#dcfce7);border:1px solid #bbf7d0}
        .summary-card.roi{background:linear-gradient(135deg,#eff6ff,#dbeafe);border:1px solid #93c5fd}
        .summary-card.net{background:linear-gradient(135deg,#fffbeb,#fef3c7);border:1px solid #fcd34d}
        .summary-label{font-size:10px;font-weight:600;text-transform:uppercase;letter-spacing:.3px}
        .summary-card.pain .summary-label{color:var(--red)}
        .summary-card.save .summary-label{color:var(--green)}
        .summary-card.roi .summary-label{color:var(--blue)}
        .summary-card.net .summary-label{color:var(--orange)}
        .summary-value{font-size:24px;font-weight:700;margin:6px 0}
        .summary-card.pain .summary-value{color:var(--red)}
        .summary-card.save .summary-value{color:var(--green)}
        .summary-card.roi .summary-value{color:var(--blue)}
        .summary-card.net .summary-value{color:var(--orange)}
        .summary-sub{font-size:10px;color:var(--text2)}
        
        /* Investment Card */
        .invest-card{background:var(--purple);color:#fff;border-radius:10px;padding:16px}
        .invest-grid{display:grid;grid-template-columns:repeat(5,1fr);gap:12px;text-align:center}
        .invest-item label{font-size:9px;opacity:.8;display:block;margin-bottom:4px}
        .invest-item input{width:80px;padding:8px;border:1px solid rgba(255,255,255,.3);border-radius:5px;background:rgba(255,255,255,.1);color:#fff;font-size:13px;font-weight:600;text-align:center}
        .invest-item input::placeholder{color:rgba(255,255,255,.5)}
        .invest-value{font-size:20px;font-weight:700;margin-top:4px}
        
        /* Talk Track */
        .talk-section{background:var(--gold);border-radius:10px;padding:16px;margin-top:16px}
        .talk-title{font-size:13px;font-weight:700;margin-bottom:12px}
        .talk-item{background:#fff;border-radius:8px;padding:12px;margin-bottom:8px}
        .talk-item:last-child{margin-bottom:0}
        .talk-step{display:inline-flex;width:20px;height:20px;align-items:center;justify-content:center;background:var(--purple);color:#fff;border-radius:50%;font-size:10px;font-weight:700;margin-right:8px}
        .talk-label{font-size:11px;font-weight:600}
        .talk-script{font-size:11px;color:var(--text2);margin-top:6px;padding:8px;background:var(--bg);border-radius:6px;border-left:3px solid var(--purple);line-height:1.6}
        .talk-script strong{color:var(--purple)}
        
        @media(max-width:700px){
            .input-grid{grid-template-columns:1fr 1fr}
            .derived-row{grid-template-columns:1fr 1fr}
            .summary-grid{grid-template-columns:1fr 1fr}
            .invest-grid{grid-template-columns:1fr 1fr}
            .metric-table{font-size:11px}
            .metric-input{width:55px;padding:6px}
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-inner">
            <div class="logo">
                <svg viewBox="0 0 100 100"><circle cx="50" cy="50" r="48" fill="#8C8C8C"/><circle cx="50" cy="50" r="44" fill="#F5B335"/><ellipse cx="50" cy="75" rx="44" ry="25" fill="#6B3FA0"/><path d="M15 50 L30 50 L38 25 L50 70 L62 30 L70 50 L85 50" stroke="#fff" stroke-width="6" fill="none" stroke-linecap="round" stroke-linejoin="round"/></svg>
                ModMed Value Calculator
            </div>
            <div class="btns">
                <button class="btn btn-light" onclick="resetAll()">Reset</button>
                <button class="btn btn-gold" onclick="copySummary()">üìã Copy Summary</button>
            </div>
        </div>
    </header>

    <main class="main">
        <!-- STEP 1: PRACTICE PROFILE -->
        <div class="step">
            <div class="step-header">
                <div>
                    <div class="step-title"><span class="step-num">1</span>Practice Profile</div>
                    <div class="step-subtitle">Enter your practice details to calculate baseline metrics</div>
                </div>
            </div>
            <div class="step-body">
                <div class="info-box">
                    <strong>üí° Why this matters:</strong> These inputs determine your annual patient volume and revenue, which drive all cost and savings calculations.
                </div>
                
                <div style="display:flex;gap:8px;margin-bottom:14px">
                    <button class="btn" style="flex:1;background:var(--purple);color:#fff" onclick="setSpec('plastic')" id="sp-plastic">Plastic Surgery</button>
                    <button class="btn" style="flex:1;background:var(--bg);color:var(--text)" onclick="setSpec('allergy')" id="sp-allergy">Allergy/Immunology</button>
                </div>
                
                <div class="input-grid">
                    <div class="input-box">
                        <label>Providers</label>
                        <input type="number" id="providers" value="2" min="1" oninput="calc()">
                        <span class="hint">Physicians, PAs, NPs</span>
                    </div>
                    <div class="input-box">
                        <label>Support Staff</label>
                        <input type="number" id="staff" value="6" min="0" oninput="calc()">
                        <span class="hint">MGMA avg: 3.5 per provider</span>
                    </div>
                    <div class="input-box">
                        <label>Patients/Provider/Day</label>
                        <input type="number" id="ppd" value="18" min="1" oninput="calc()">
                        <span class="hint">Specialty avg: 15-25</span>
                    </div>
                    <div class="input-box">
                        <label>Avg Revenue/Visit</label>
                        <input type="number" id="rpv" value="425" min="0" oninput="calc()">
                        <span class="hint">Include procedures</span>
                    </div>
                    <div class="input-box">
                        <label>Work Days/Year</label>
                        <input type="number" id="workdays" value="240" oninput="calc()">
                        <span class="hint">Typical: 230-250</span>
                    </div>
                    <div class="input-box">
                        <label>Staff Hourly Cost</label>
                        <input type="number" id="staffrate" value="28" oninput="calc()">
                        <span class="hint">Loaded cost avg</span>
                    </div>
                </div>
                
                <div class="derived-row">
                    <div class="derived-stat">
                        <div class="derived-stat-label">Annual Visits</div>
                        <div class="derived-stat-value" id="annualVisits">0</div>
                    </div>
                    <div class="derived-stat">
                        <div class="derived-stat-label">Annual Revenue</div>
                        <div class="derived-stat-value" id="annualRevenue">$0</div>
                    </div>
                    <div class="derived-stat">
                        <div class="derived-stat-label">Active Patients</div>
                        <div class="derived-stat-value" id="activePatients">0</div>
                    </div>
                    <div class="derived-stat">
                        <div class="derived-stat-label">Provider Opp. Cost</div>
                        <div class="derived-stat-value">$200/hr</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- STEP 2: CURRENT STATE vs MODMED -->
        <div class="step">
            <div class="step-header">
                <div>
                    <div class="step-title"><span class="step-num">2</span>Current State vs. ModMed</div>
                    <div class="step-subtitle">Enter your current metrics and see projected improvements</div>
                </div>
                <div class="step-total">
                    <div class="step-total-label">Total Annual Savings</div>
                    <div class="step-total-value green" id="totalSavings">$0</div>
                </div>
            </div>
            <div class="step-body">
                <div class="info-box blue">
                    <strong>üìä How to read this table:</strong> Enter YOUR current numbers in the red column. Adjust ModMed targets in the green column based on your expectations. Savings calculate automatically.
                </div>
                
                <table class="metric-table">
                    <thead>
                        <tr>
                            <th>Metric</th>
                            <th class="current">Your Current State</th>
                            <th>Annual Cost</th>
                            <th class="modmed">With ModMed</th>
                            <th class="savings">Annual Savings</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- CHARTING -->
                        <tr>
                            <td>
                                <div class="metric-name">üìù After-Hours Charting</div>
                                <div class="metric-desc">Provider documentation time outside patient hours</div>
                                <div class="metric-formula" id="chartingFormula"></div>
                            </td>
                            <td><input type="number" class="metric-input red" id="chartingCurr" value="1.5" step="0.5" oninput="calc()"> hrs/day</td>
                            <td><span class="metric-cost" id="chartingCost">$0</span></td>
                            <td><input type="number" class="metric-input green" id="chartingTarget" value="0.5" step="0.5" oninput="calc()"> hrs/day</td>
                            <td><span class="metric-save" id="chartingSave">$0</span></td>
                        </tr>
                        
                        <!-- NO-SHOWS -->
                        <tr>
                            <td>
                                <div class="metric-name">üìÖ No-Show Rate</div>
                                <div class="metric-desc">Missed appointments = lost revenue</div>
                                <div class="metric-formula" id="noshowFormula"></div>
                            </td>
                            <td><input type="number" class="metric-input red" id="noshowCurr" value="18" oninput="calc()">%</td>
                            <td><span class="metric-cost" id="noshowCost">$0</span></td>
                            <td><input type="number" class="metric-input green" id="noshowTarget" value="8" oninput="calc()">%</td>
                            <td><span class="metric-save" id="noshowSave">$0</span></td>
                        </tr>
                        
                        <!-- COLLECTIONS -->
                        <tr>
                            <td>
                                <div class="metric-name">üíµ Collection Rate</div>
                                <div class="metric-desc">% of billable revenue actually collected</div>
                                <div class="metric-formula" id="collFormula"></div>
                            </td>
                            <td><input type="number" class="metric-input red" id="collCurr" value="89" oninput="calc()">%</td>
                            <td><span class="metric-cost" id="collCost">$0</span></td>
                            <td><input type="number" class="metric-input green" id="collTarget" value="95" oninput="calc()">%</td>
                            <td><span class="metric-save" id="collSave">$0</span></td>
                        </tr>
                        
                        <!-- DENIALS -->
                        <tr>
                            <td>
                                <div class="metric-name">‚ùå Claim Denial Rate</div>
                                <div class="metric-desc">Rejected claims requiring rework</div>
                                <div class="metric-formula" id="denialFormula"></div>
                            </td>
                            <td><input type="number" class="metric-input red" id="denialCurr" value="12" oninput="calc()">%</td>
                            <td><span class="metric-cost" id="denialCost">$0</span></td>
                            <td><input type="number" class="metric-input green" id="denialTarget" value="5" oninput="calc()">%</td>
                            <td><span class="metric-save" id="denialSave">$0</span></td>
                        </tr>
                        
                        <!-- CHARGE CAPTURE -->
                        <tr>
                            <td>
                                <div class="metric-name">üí∞ Charge Capture</div>
                                <div class="metric-desc">% of services properly billed</div>
                                <div class="metric-formula" id="captureFormula"></div>
                            </td>
                            <td><input type="number" class="metric-input red" id="captureCurr" value="94" oninput="calc()">%</td>
                            <td><span class="metric-cost" id="captureCost">$0</span></td>
                            <td><input type="number" class="metric-input green" id="captureTarget" value="99" oninput="calc()">%</td>
                            <td><span class="metric-save" id="captureSave">$0</span></td>
                        </tr>
                        
                        <!-- PHONE VOLUME -->
                        <tr>
                            <td>
                                <div class="metric-name">üìû Phone Call Volume</div>
                                <div class="metric-desc">Staff time handling calls (4 min avg)</div>
                                <div class="metric-formula" id="phoneFormula"></div>
                            </td>
                            <td><input type="number" class="metric-input red" id="phoneCurr" value="60" oninput="calc()"> calls/day</td>
                            <td><span class="metric-cost" id="phoneCost">$0</span></td>
                            <td><input type="number" class="metric-input green" id="phoneTarget" value="35" oninput="calc()"> calls/day</td>
                            <td><span class="metric-save" id="phoneSave">$0</span></td>
                        </tr>
                        
                        <!-- RETENTION -->
                        <tr>
                            <td>
                                <div class="metric-name">üîÑ Patient Retention</div>
                                <div class="metric-desc">% returning within 18 months</div>
                                <div class="metric-formula" id="retFormula"></div>
                            </td>
                            <td><input type="number" class="metric-input red" id="retCurr" value="72" oninput="calc()">%</td>
                            <td><span class="metric-cost" id="retCost">$0</span><span style="font-size:9px;color:var(--muted)"> lost</span></td>
                            <td><input type="number" class="metric-input green" id="retTarget" value="85" oninput="calc()">%</td>
                            <td><span class="metric-save" id="retSave">$0</span></td>
                        </tr>
                        
                        <!-- SUBTOTAL -->
                        <tr class="subtotal-row">
                            <td><div class="metric-name">SUBTOTAL</div></td>
                            <td></td>
                            <td><span class="metric-cost" id="subtotalCost">$0</span></td>
                            <td></td>
                            <td><span class="metric-save" id="subtotalSave">$0</span></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- STEP 3: INVESTMENT -->
        <div class="step">
            <div class="step-header">
                <div>
                    <div class="step-title"><span class="step-num">3</span>ModMed Investment</div>
                    <div class="step-subtitle">Configure pricing based on your quote</div>
                </div>
                <div class="step-total">
                    <div class="step-total-label">Year 1 Total</div>
                    <div class="step-total-value blue" id="investTotal">$0</div>
                </div>
            </div>
            <div class="step-body">
                <div class="info-box">
                    <strong>üí° Customize these values:</strong> Adjust based on your specific ModMed quote. All fields are editable.
                </div>
                
                <div class="invest-card">
                    <div class="invest-grid">
                        <div class="invest-item">
                            <label>Per Provider/Month</label>
                            <input type="number" id="invProv" value="700" oninput="calc()">
                        </div>
                        <div class="invest-item">
                            <label>Per Staff/Month</label>
                            <input type="number" id="invStaff" value="100" oninput="calc()">
                        </div>
                        <div class="invest-item">
                            <label>Implementation</label>
                            <input type="number" id="invImpl" value="15000" oninput="calc()">
                        </div>
                        <div class="invest-item">
                            <label>Annual Support</label>
                            <input type="number" id="invSupport" value="0" oninput="calc()">
                        </div>
                        <div class="invest-item">
                            <label>Monthly Total</label>
                            <div class="invest-value" id="invMonthly">$0</div>
                        </div>
                    </div>
                </div>
                
                <div style="margin-top:14px;display:grid;grid-template-columns:repeat(3,1fr);gap:12px;text-align:center">
                    <div style="padding:12px;background:#f8fafc;border-radius:8px">
                        <div style="font-size:10px;color:var(--muted)">YEAR 1 COST</div>
                        <div style="font-size:18px;font-weight:700;color:var(--purple)" id="invYear1">$0</div>
                        <div style="font-size:9px;color:var(--text2)">(Monthly √ó 12) + Implementation</div>
                    </div>
                    <div style="padding:12px;background:#f8fafc;border-radius:8px">
                        <div style="font-size:10px;color:var(--muted)">ONGOING ANNUAL</div>
                        <div style="font-size:18px;font-weight:700;color:var(--purple)" id="invOngoing">$0</div>
                        <div style="font-size:9px;color:var(--text2)">Monthly √ó 12 + Support</div>
                    </div>
                    <div style="padding:12px;background:#f8fafc;border-radius:8px">
                        <div style="font-size:10px;color:var(--muted)">3-YEAR TOTAL</div>
                        <div style="font-size:18px;font-weight:700;color:var(--purple)" id="inv3Year">$0</div>
                        <div style="font-size:9px;color:var(--text2)">Year 1 + (Ongoing √ó 2)</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- STEP 4: ROI SUMMARY -->
        <div class="step">
            <div class="step-header">
                <div>
                    <div class="step-title"><span class="step-num">4</span>Return on Investment</div>
                    <div class="step-subtitle">Your bottom line impact</div>
                </div>
            </div>
            <div class="step-body">
                <div class="summary-grid">
                    <div class="summary-card pain">
                        <div class="summary-label">üíî Annual Loss</div>
                        <div class="summary-value" id="totalPain">$0</div>
                        <div class="summary-sub">Cost of doing nothing</div>
                    </div>
                    <div class="summary-card save">
                        <div class="summary-label">‚ú® Annual Savings</div>
                        <div class="summary-value" id="totalSave">$0</div>
                        <div class="summary-sub">With ModMed</div>
                    </div>
                    <div class="summary-card roi">
                        <div class="summary-label">üìà Year 1 ROI</div>
                        <div class="summary-value" id="roi">0%</div>
                        <div class="summary-sub" id="payback">Payback: -- months</div>
                    </div>
                    <div class="summary-card net">
                        <div class="summary-label">üéØ 3-Year Net Benefit</div>
                        <div class="summary-value" id="net3">$0</div>
                        <div class="summary-sub">Savings minus investment</div>
                    </div>
                </div>
                
                <div style="margin-top:16px;padding:16px;background:#f0fdf4;border:1px solid #bbf7d0;border-radius:10px;text-align:center">
                    <div style="font-size:12px;color:#166534;margin-bottom:8px">üìä Value Summary</div>
                    <div style="font-size:14px;color:var(--text)">
                        For every <strong style="color:var(--purple)" id="sumInvest">$1</strong> invested in Year 1, 
                        you recover <strong style="color:var(--green)" id="sumReturn">$0</strong> in savings ‚Äî 
                        a <strong style="color:var(--blue)" id="sumRoi">0%</strong> return.
                    </div>
                </div>
            </div>
        </div>

        <!-- TALK TRACK -->
        <div class="talk-section">
            <div class="talk-title">üéØ Your Conversation Guide</div>
            <div class="talk-item">
                <div class="talk-label"><span class="talk-step">1</span>Discovery ‚Äî Uncover the Pain</div>
                <div class="talk-script">"Walk me through a typical day. Where do you feel like you're <strong>losing time or leaving money on the table</strong>?"</div>
            </div>
            <div class="talk-item">
                <div class="talk-label"><span class="talk-step">2</span>Quantify ‚Äî Make It Real</div>
                <div class="talk-script">"Based on your numbers, you're losing approximately <strong id="scriptPain">$0</strong> every year to these inefficiencies. Over 3 years, that's <strong id="scriptPain3">$0</strong>."</div>
            </div>
            <div class="talk-item">
                <div class="talk-label"><span class="talk-step">3</span>Solution ‚Äî Show the Path</div>
                <div class="talk-script">"With ModMed, you'd recover <strong id="scriptSave">$0</strong> annually by reducing no-shows from <strong id="scriptNS1">18%</strong> to <strong id="scriptNS2">8%</strong>, improving collections to <strong id="scriptColl">95%</strong>, and cutting charting time to <strong id="scriptChart">0.5</strong> hours/day."</div>
            </div>
            <div class="talk-item">
                <div class="talk-label"><span class="talk-step">4</span>Close ‚Äî Justify the Investment</div>
                <div class="talk-script">"For <strong id="scriptInv">$0</strong> in Year 1, you get <strong id="scriptSave2">$0</strong> back ‚Äî a <strong id="scriptRoi">0%</strong> ROI with a <strong id="scriptPayback">--</strong>-month payback. Over 3 years, that's <strong id="scriptNet3">$0</strong> net benefit."</div>
            </div>
        </div>
    </main>

    <script>
        const specs={plastic:{rpv:425,charting:1.5,noshow:18,denial:12,coll:89,capture:94,ret:72,phone:60},allergy:{rpv:195,charting:1.2,noshow:20,denial:14,coll:87,capture:92,ret:75,phone:80}};
        let currentSpec='plastic';
        
        function fmt(n){return n>=1e6?'$'+(n/1e6).toFixed(1)+'M':n>=1e3?'$'+Math.round(n/1e3)+'K':'$'+Math.round(n)}
        function getN(id,d=0){return parseFloat(document.getElementById(id)?.value)||d}
        function setN(id,v){const e=document.getElementById(id);if(e)e.value=v}
        
        function setSpec(s){
            currentSpec=s;
            document.getElementById('sp-plastic').style.background=s==='plastic'?'var(--purple)':'var(--bg)';
            document.getElementById('sp-plastic').style.color=s==='plastic'?'#fff':'var(--text)';
            document.getElementById('sp-allergy').style.background=s==='allergy'?'var(--purple)':'var(--bg)';
            document.getElementById('sp-allergy').style.color=s==='allergy'?'#fff':'var(--text)';
            const c=specs[s];
            setN('rpv',c.rpv);setN('chartingCurr',c.charting);setN('noshowCurr',c.noshow);
            setN('denialCurr',c.denial);setN('collCurr',c.coll);setN('captureCurr',c.capture);
            setN('retCurr',c.ret);setN('phoneCurr',c.phone);
            calc();
        }
        
        function calc(){
            const prov=getN('providers',2),staff=getN('staff',6),ppd=getN('ppd',18),rpv=getN('rpv',425);
            const days=getN('workdays',240),staffRate=getN('staffrate',28),provRate=200;
            const visits=prov*ppd*days,revenue=visits*rpv,patients=Math.round(visits/3.5);
            
            document.getElementById('annualVisits').textContent=visits.toLocaleString();
            document.getElementById('annualRevenue').textContent=fmt(revenue);
            document.getElementById('activePatients').textContent=patients.toLocaleString();
            
            let totalCost=0,totalSave=0;
            
            // CHARTING
            const chartCurr=getN('chartingCurr',1.5),chartTgt=getN('chartingTarget',0.5);
            const chartCost=chartCurr*provRate*days*prov;
            const chartSave=(chartCurr-chartTgt)*provRate*days*prov;
            document.getElementById('chartingCost').textContent=fmt(chartCost);
            document.getElementById('chartingSave').textContent=fmt(Math.max(0,chartSave));
            document.getElementById('chartingFormula').textContent=`${chartCurr}hrs √ó $${provRate}/hr √ó ${days}days √ó ${prov}prov = ${fmt(chartCost)}`;
            totalCost+=chartCost;totalSave+=Math.max(0,chartSave);
            
            // NO-SHOWS
            const nsCurr=getN('noshowCurr',18)/100,nsTgt=getN('noshowTarget',8)/100;
            const nsCost=visits*nsCurr*rpv;
            const nsSave=visits*(nsCurr-nsTgt)*rpv;
            document.getElementById('noshowCost').textContent=fmt(nsCost);
            document.getElementById('noshowSave').textContent=fmt(Math.max(0,nsSave));
            document.getElementById('noshowFormula').textContent=`${visits.toLocaleString()} visits √ó ${Math.round(nsCurr*100)}% √ó $${rpv} = ${fmt(nsCost)}`;
            totalCost+=nsCost;totalSave+=Math.max(0,nsSave);
            
            // COLLECTIONS
            const collCurr=getN('collCurr',89)/100,collTgt=getN('collTarget',95)/100;
            const collCost=revenue*(1-collCurr);
            const collSave=revenue*(collTgt-collCurr);
            document.getElementById('collCost').textContent=fmt(collCost);
            document.getElementById('collSave').textContent=fmt(Math.max(0,collSave));
            document.getElementById('collFormula').textContent=`${fmt(revenue)} √ó (100% - ${Math.round(collCurr*100)}%) = ${fmt(collCost)} lost`;
            totalCost+=collCost;totalSave+=Math.max(0,collSave);
            
            // DENIALS
            const denCurr=getN('denialCurr',12)/100,denTgt=getN('denialTarget',5)/100,denCostPer=45;
            const denCost=visits*denCurr*denCostPer;
            const denSave=visits*(denCurr-denTgt)*denCostPer;
            document.getElementById('denialCost').textContent=fmt(denCost);
            document.getElementById('denialSave').textContent=fmt(Math.max(0,denSave));
            document.getElementById('denialFormula').textContent=`${visits.toLocaleString()} √ó ${Math.round(denCurr*100)}% √ó $${denCostPer}/denial = ${fmt(denCost)}`;
            totalCost+=denCost;totalSave+=Math.max(0,denSave);
            
            // CAPTURE
            const capCurr=getN('captureCurr',94)/100,capTgt=getN('captureTarget',99)/100;
            const capCost=revenue*(1-capCurr);
            const capSave=revenue*(capTgt-capCurr);
            document.getElementById('captureCost').textContent=fmt(capCost);
            document.getElementById('captureSave').textContent=fmt(Math.max(0,capSave));
            document.getElementById('captureFormula').textContent=`${fmt(revenue)} √ó (100% - ${Math.round(capCurr*100)}%) = ${fmt(capCost)} missed`;
            totalCost+=capCost;totalSave+=Math.max(0,capSave);
            
            // PHONE
            const phoneCurr=getN('phoneCurr',60),phoneTgt=getN('phoneTarget',35),phoneMin=4;
            const phoneCost=(phoneCurr*phoneMin/60)*staffRate*days;
            const phoneSave=((phoneCurr-phoneTgt)*phoneMin/60)*staffRate*days;
            document.getElementById('phoneCost').textContent=fmt(phoneCost);
            document.getElementById('phoneSave').textContent=fmt(Math.max(0,phoneSave));
            document.getElementById('phoneFormula').textContent=`${phoneCurr} √ó ${phoneMin}min √ó $${staffRate}/hr √ó ${days}days = ${fmt(phoneCost)}`;
            totalCost+=phoneCost;totalSave+=Math.max(0,phoneSave);
            
            // RETENTION
            const retCurr=getN('retCurr',72)/100,retTgt=getN('retTarget',85)/100,retVal=rpv*3;
            const retCost=patients*(1-retCurr)*retVal;
            const retSave=patients*(retTgt-retCurr)*retVal;
            document.getElementById('retCost').textContent=fmt(retCost);
            document.getElementById('retSave').textContent=fmt(Math.max(0,retSave));
            document.getElementById('retFormula').textContent=`${patients.toLocaleString()}pts √ó ${Math.round((1-retCurr)*100)}% lost √ó $${retVal}/pt = ${fmt(retCost)}`;
            totalCost+=retCost;totalSave+=Math.max(0,retSave);
            
            // SUBTOTALS
            document.getElementById('subtotalCost').textContent=fmt(totalCost);
            document.getElementById('subtotalSave').textContent=fmt(totalSave);
            document.getElementById('totalSavings').textContent=fmt(totalSave);
            
            // INVESTMENT
            const invProv=getN('invProv',700),invStaff=getN('invStaff',100),invImpl=getN('invImpl',15000),invSupport=getN('invSupport',0);
            const monthly=(prov*invProv)+(staff*invStaff);
            const year1=(monthly*12)+invImpl;
            const ongoing=(monthly*12)+invSupport;
            const inv3yr=year1+(ongoing*2);
            document.getElementById('invMonthly').textContent=fmt(monthly);
            document.getElementById('invYear1').textContent=fmt(year1);
            document.getElementById('invOngoing').textContent=fmt(ongoing);
            document.getElementById('inv3Year').textContent=fmt(inv3yr);
            document.getElementById('investTotal').textContent=fmt(year1);
            
            // ROI
            const net1=totalSave-year1;
            const net3=(totalSave*3)-inv3yr;
            const roi=year1>0?Math.round((net1/year1)*100):0;
            const payback=(totalSave/12)>0?Math.ceil(year1/(totalSave/12)):99;
            
            document.getElementById('totalPain').textContent=fmt(totalCost);
            document.getElementById('totalSave').textContent=fmt(totalSave);
            document.getElementById('roi').textContent=roi+'%';
            document.getElementById('payback').textContent='Payback: '+(payback>24?'24+':payback)+' months';
            document.getElementById('net3').textContent=fmt(net3);
            
            document.getElementById('sumInvest').textContent=fmt(year1);
            document.getElementById('sumReturn').textContent=fmt(totalSave);
            document.getElementById('sumRoi').textContent=roi+'%';
            
            // TALK TRACK
            document.getElementById('scriptPain').textContent=fmt(totalCost);
            document.getElementById('scriptPain3').textContent=fmt(totalCost*3);
            document.getElementById('scriptSave').textContent=fmt(totalSave);
            document.getElementById('scriptNS1').textContent=Math.round(nsCurr*100)+'%';
            document.getElementById('scriptNS2').textContent=Math.round(nsTgt*100)+'%';
            document.getElementById('scriptColl').textContent=Math.round(collTgt*100)+'%';
            document.getElementById('scriptChart').textContent=chartTgt;
            document.getElementById('scriptInv').textContent=fmt(year1);
            document.getElementById('scriptSave2').textContent=fmt(totalSave);
            document.getElementById('scriptRoi').textContent=roi+'%';
            document.getElementById('scriptPayback').textContent=payback>24?'24+':payback;
            document.getElementById('scriptNet3').textContent=fmt(net3);
            
            window.data={prov,staff,totalCost,totalSave,year1,ongoing,net1,net3,roi,payback};
        }
        
        function resetAll(){setSpec('plastic');setN('providers',2);setN('staff',6);setN('ppd',18);calc();}
        
        function copySummary(){
            const d=window.data;
            const t=`ModMed ROI Analysis
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
${d.prov} Providers | ${d.staff} Staff

CURRENT STATE
Annual inefficiency cost: ${fmt(d.totalCost)}

WITH MODMED
Annual savings: ${fmt(d.totalSave)}
Year 1 investment: ${fmt(d.year1)}
Year 1 ROI: ${d.roi}%
Payback: ${d.payback>24?'24+':d.payback} months

3-YEAR OUTLOOK
Total savings: ${fmt(d.totalSave*3)}
Total investment: ${fmt(d.year1+(d.ongoing*2))}
Net benefit: ${fmt(d.net3)}
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê`;
            navigator.clipboard.writeText(t).then(()=>{
                const b=document.querySelector('.btn-gold');
                b.textContent='‚úì Copied!';
                setTimeout(()=>b.textContent='üìã Copy Summary',2000);
            });
        }
        
        calc();
    </script>
</body>
</html>
