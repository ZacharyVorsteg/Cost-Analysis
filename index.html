<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ModMed Value Calculator</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root{--purple:#6B3FA0;--purple-light:#8B5FC0;--gold:#F5B335;--bg:#f8f9fc;--card:#fff;--text:#1a1a2e;--text2:#5a5a6e;--muted:#9a9aaa;--border:#e8e8ee;--red:#e53935;--green:#2e7d32;--blue:#1976d2}
        *{box-sizing:border-box;margin:0;padding:0}
        body{font-family:'Inter',sans-serif;background:var(--bg);color:var(--text);line-height:1.5;font-size:14px}
        
        .header{background:linear-gradient(135deg,var(--purple),var(--purple-light));color:#fff;padding:12px 20px;position:sticky;top:0;z-index:100}
        .header-content{max-width:900px;margin:0 auto;display:flex;justify-content:space-between;align-items:center}
        .logo{display:flex;align-items:center;gap:8px;font-weight:600;font-size:16px}
        .logo svg{width:32px;height:32px}
        .header-actions{display:flex;gap:6px}
        .btn{padding:8px 14px;border-radius:8px;font-size:12px;font-weight:600;border:none;cursor:pointer}
        .btn-gold{background:var(--gold);color:#000}
        .btn-white{background:rgba(255,255,255,.2);color:#fff}
        
        .main{max-width:900px;margin:0 auto;padding:16px}
        .card{background:var(--card);border-radius:12px;padding:16px;margin-bottom:12px;box-shadow:0 1px 4px rgba(0,0,0,.04)}
        .card-title{font-size:13px;font-weight:600;color:var(--purple);margin-bottom:12px;display:flex;align-items:center;gap:6px}
        
        /* Practice Setup */
        .size-tabs{display:grid;grid-template-columns:repeat(4,1fr);gap:6px;margin-bottom:12px}
        .size-tab{padding:10px 8px;text-align:center;background:var(--bg);border:2px solid var(--border);border-radius:8px;font-size:11px;font-weight:600;cursor:pointer;transition:all .2s}
        .size-tab.active{background:var(--purple);color:#fff;border-color:var(--purple)}
        .size-tab small{display:block;font-weight:400;opacity:.7;margin-top:2px}
        
        .specialty-row{display:flex;gap:6px;margin-bottom:12px}
        .specialty-btn{flex:1;padding:10px;text-align:center;background:var(--bg);border:2px solid var(--border);border-radius:8px;font-size:12px;font-weight:600;cursor:pointer}
        .specialty-btn.active{background:var(--purple);color:#fff;border-color:var(--purple)}
        
        .input-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:10px}
        .input-group{display:flex;flex-direction:column;gap:2px}
        .input-group label{font-size:11px;font-weight:500;color:var(--text2)}
        .input-group input,.input-group select{background:var(--bg);border:1px solid var(--border);border-radius:6px;padding:10px;font-size:14px;font-weight:600}
        .input-group input:focus,.input-group select:focus{outline:none;border-color:var(--purple)}
        .input-hint{font-size:10px;color:var(--muted)}
        .benchmark{font-size:10px;color:var(--blue);font-style:italic}
        
        /* Comparison Table */
        .compare-section{margin-bottom:12px}
        .section-header{display:flex;justify-content:space-between;align-items:center;padding:10px 12px;background:var(--bg);border-radius:8px 8px 0 0;border-bottom:1px solid var(--border)}
        .section-header h4{font-size:12px;font-weight:600;color:var(--text2)}
        .section-total{font-size:14px;font-weight:700;color:var(--red)}
        
        .compare-table{width:100%;border-collapse:collapse;font-size:12px}
        .compare-table th{font-size:10px;font-weight:600;text-transform:uppercase;letter-spacing:.3px;padding:8px 6px;text-align:center;background:var(--bg)}
        .compare-table th:first-child{text-align:left;width:35%}
        .compare-table th.current{color:var(--red)}
        .compare-table th.modmed{color:var(--green)}
        .compare-table th.save{color:var(--blue)}
        .compare-table td{padding:8px 6px;border-bottom:1px solid var(--border);text-align:center}
        .compare-table td:first-child{text-align:left}
        .compare-table td.current{color:var(--red);font-weight:500}
        .compare-table td.modmed{color:var(--green);font-weight:500}
        .compare-table td.save{color:var(--blue);font-weight:600}
        .compare-table tr:last-child td{border-bottom:none}
        .metric-name{font-weight:500}
        .metric-detail{font-size:10px;color:var(--muted)}
        .editable{width:50px;background:#fff;border:1px solid var(--border);border-radius:4px;padding:4px;font-size:11px;text-align:center}
        .editable:focus{outline:none;border-color:var(--purple)}
        
        /* Summary Cards */
        .summary-row{display:grid;grid-template-columns:repeat(4,1fr);gap:10px;margin-bottom:12px}
        .summary-card{text-align:center;padding:14px 8px;border-radius:10px}
        .summary-card.pain{background:linear-gradient(135deg,#ffebee,#ffcdd2)}
        .summary-card.save{background:linear-gradient(135deg,#e8f5e9,#c8e6c9)}
        .summary-card.roi{background:linear-gradient(135deg,#e3f2fd,#bbdefb)}
        .summary-card.net{background:linear-gradient(135deg,#fff3e0,#ffe0b2)}
        .summary-label{font-size:10px;font-weight:600;text-transform:uppercase;letter-spacing:.3px}
        .summary-card.pain .summary-label{color:var(--red)}
        .summary-card.save .summary-label{color:var(--green)}
        .summary-card.roi .summary-label{color:var(--blue)}
        .summary-card.net .summary-label{color:#e65100}
        .summary-value{font-size:22px;font-weight:700;margin:4px 0}
        .summary-card.pain .summary-value{color:var(--red)}
        .summary-card.save .summary-value{color:var(--green)}
        .summary-card.roi .summary-value{color:var(--blue)}
        .summary-card.net .summary-value{color:#e65100}
        .summary-sub{font-size:10px;color:var(--muted)}
        
        /* Talk Track */
        .talk-section{background:var(--gold);border-radius:12px;padding:14px}
        .talk-title{font-size:13px;font-weight:700;margin-bottom:10px}
        .talk-card{background:#fff;border-radius:8px;padding:12px;margin-bottom:8px}
        .talk-card:last-child{margin-bottom:0}
        .talk-step{display:inline-flex;width:20px;height:20px;align-items:center;justify-content:center;background:var(--purple);color:#fff;border-radius:50%;font-size:10px;font-weight:700;margin-right:8px}
        .talk-label{font-size:12px;font-weight:600}
        .talk-script{font-size:12px;color:var(--text2);line-height:1.5;padding:8px;background:var(--bg);border-radius:6px;margin-top:6px;border-left:3px solid var(--purple)}
        .talk-script strong{color:var(--purple)}
        
        /* Investment */
        .invest-row{display:grid;grid-template-columns:repeat(4,1fr);gap:8px;padding:12px;background:var(--purple);border-radius:8px;color:#fff}
        .invest-item{text-align:center}
        .invest-label{font-size:10px;opacity:.8}
        .invest-value{font-size:16px;font-weight:700;margin-top:2px}
        .invest-input{width:60px;background:rgba(255,255,255,.2);border:1px solid rgba(255,255,255,.3);border-radius:4px;padding:4px;font-size:12px;color:#fff;text-align:center}
        
        @media(max-width:700px){
            .input-grid{grid-template-columns:repeat(2,1fr)}
            .summary-row{grid-template-columns:repeat(2,1fr)}
            .size-tabs{grid-template-columns:repeat(2,1fr)}
            .invest-row{grid-template-columns:repeat(2,1fr)}
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <div class="logo">
                <svg viewBox="0 0 100 100"><circle cx="50" cy="50" r="48" fill="#8C8C8C"/><circle cx="50" cy="50" r="44" fill="#F5B335"/><ellipse cx="50" cy="75" rx="44" ry="25" fill="#6B3FA0"/><path d="M15 50 L30 50 L38 25 L50 70 L62 30 L70 50 L85 50" stroke="#fff" stroke-width="6" fill="none" stroke-linecap="round" stroke-linejoin="round"/></svg>
                ModMed Value Calculator
            </div>
            <div class="header-actions">
                <button class="btn btn-white" onclick="resetAll()">Reset</button>
                <button class="btn btn-gold" onclick="copySummary()">üìã Copy</button>
            </div>
        </div>
    </header>

    <main class="main">
        <!-- PRACTICE SETUP -->
        <div class="card">
            <div class="card-title">üè• Practice Profile</div>
            
            <div class="size-tabs">
                <div class="size-tab" onclick="setSize('startup')" id="size-startup">Startup<small>1 provider</small></div>
                <div class="size-tab active" onclick="setSize('small')" id="size-small">Small<small>2-3 providers</small></div>
                <div class="size-tab" onclick="setSize('medium')" id="size-medium">Medium<small>4-6 providers</small></div>
                <div class="size-tab" onclick="setSize('large')" id="size-large">Large<small>7+ providers</small></div>
            </div>
            
            <div class="specialty-row">
                <div class="specialty-btn active" onclick="setSpecialty('plastic')" id="spec-plastic">Plastic Surgery</div>
                <div class="specialty-btn" onclick="setSpecialty('derm')" id="spec-derm">Dermatology</div>
                <div class="specialty-btn" onclick="setSpecialty('allergy')" id="spec-allergy">Allergy</div>
                <div class="specialty-btn" onclick="setSpecialty('ortho')" id="spec-ortho">Orthopedics</div>
            </div>
            
            <div class="input-grid">
                <div class="input-group">
                    <label>Practice Name</label>
                    <input type="text" id="name" placeholder="Optional" oninput="calc()">
                </div>
                <div class="input-group">
                    <label>Providers</label>
                    <input type="number" id="providers" value="2" min="1" oninput="calc()">
                </div>
                <div class="input-group">
                    <label>Support Staff (FTEs)</label>
                    <input type="number" id="staff" value="6" min="0" oninput="calc()">
                    <span class="benchmark">Typical: 3-4 per provider</span>
                </div>
                <div class="input-group">
                    <label>Patients/Provider/Day</label>
                    <input type="number" id="patients" value="18" min="1" oninput="calc()">
                    <span class="benchmark">Industry: 15-25</span>
                </div>
                <div class="input-group">
                    <label>Avg Revenue/Visit ($)</label>
                    <input type="number" id="revenue" value="425" min="0" oninput="calc()">
                    <span class="benchmark">Includes procedures</span>
                </div>
                <div class="input-group">
                    <label>Current EHR</label>
                    <select id="ehr" onchange="calc()">
                        <option value="paper">Paper/Manual</option>
                        <option value="legacy">Legacy EHR (10+ yrs)</option>
                        <option value="generic" selected>Generic EHR</option>
                        <option value="competitor">Specialty EHR</option>
                    </select>
                </div>
            </div>
        </div>

        <!-- CLINICAL EFFICIENCY -->
        <div class="card compare-section">
            <div class="section-header">
                <h4>ü©∫ Clinical Efficiency</h4>
                <span class="section-total" id="clinicalTotal">$0</span>
            </div>
            <table class="compare-table">
                <thead>
                    <tr>
                        <th>Metric</th>
                        <th class="current">Current</th>
                        <th class="modmed">With ModMed</th>
                        <th class="save">Annual Savings</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><div class="metric-name">After-Hours Charting</div><div class="metric-detail">Provider time @ $200/hr opportunity cost</div></td>
                        <td class="current"><input type="number" class="editable" id="charting" value="1.5" step="0.5" oninput="calc()"> hrs/day</td>
                        <td class="modmed" id="chartingMM">0.5 hrs</td>
                        <td class="save" id="chartingSave">$0</td>
                    </tr>
                    <tr>
                        <td><div class="metric-name">Prior Authorizations</div><div class="metric-detail">Staff time @ $28/hr avg</div></td>
                        <td class="current"><input type="number" class="editable" id="paCount" value="12" oninput="calc()"> /week</td>
                        <td class="modmed" id="paMM">5 /week</td>
                        <td class="save" id="paSave">$0</td>
                    </tr>
                    <tr>
                        <td><div class="metric-name">Chart Prep Time</div><div class="metric-detail">Minutes per patient</div></td>
                        <td class="current"><input type="number" class="editable" id="chartPrep" value="8" oninput="calc()"> min</td>
                        <td class="modmed" id="chartPrepMM">3 min</td>
                        <td class="save" id="chartPrepSave">$0</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- REVENUE CYCLE -->
        <div class="card compare-section">
            <div class="section-header">
                <h4>üí∞ Revenue Cycle</h4>
                <span class="section-total" id="revenueTotal">$0</span>
            </div>
            <table class="compare-table">
                <thead>
                    <tr>
                        <th>Metric</th>
                        <th class="current">Current</th>
                        <th class="modmed">With ModMed</th>
                        <th class="save">Annual Impact</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><div class="metric-name">Claim Denial Rate</div><div class="metric-detail">Industry avg 5-10%, poor >15%</div></td>
                        <td class="current"><input type="number" class="editable" id="denial" value="12" oninput="calc()">%</td>
                        <td class="modmed" id="denialMM">5%</td>
                        <td class="save" id="denialSave">$0</td>
                    </tr>
                    <tr>
                        <td><div class="metric-name">Collection Rate</div><div class="metric-detail">Target 95%+, avg 88-92%</div></td>
                        <td class="current"><input type="number" class="editable" id="collection" value="89" oninput="calc()">%</td>
                        <td class="modmed">95%+</td>
                        <td class="save" id="collectionSave">$0</td>
                    </tr>
                    <tr>
                        <td><div class="metric-name">Days in A/R</div><div class="metric-detail">Good <35, avg 40-55</div></td>
                        <td class="current"><input type="number" class="editable" id="daysAR" value="48" oninput="calc()"> days</td>
                        <td class="modmed">32 days</td>
                        <td class="save" id="arSave">$0</td>
                    </tr>
                    <tr>
                        <td><div class="metric-name">Charge Capture</div><div class="metric-detail">% of services billed correctly</div></td>
                        <td class="current"><input type="number" class="editable" id="capture" value="94" oninput="calc()">%</td>
                        <td class="modmed">99%</td>
                        <td class="save" id="captureSave">$0</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- PATIENT ENGAGEMENT -->
        <div class="card compare-section">
            <div class="section-header">
                <h4>üì± Patient Engagement</h4>
                <span class="section-total" id="engageTotal">$0</span>
            </div>
            <table class="compare-table">
                <thead>
                    <tr>
                        <th>Metric</th>
                        <th class="current">Current</th>
                        <th class="modmed">With ModMed</th>
                        <th class="save">Annual Impact</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><div class="metric-name">No-Show Rate</div><div class="metric-detail">Industry 15-20%, best-in-class 5-8%</div></td>
                        <td class="current"><input type="number" class="editable" id="noShow" value="18" oninput="calc()">%</td>
                        <td class="modmed" id="noShowMM">8%</td>
                        <td class="save" id="noShowSave">$0</td>
                    </tr>
                    <tr>
                        <td><div class="metric-name">Online Scheduling</div><div class="metric-detail">% of appts booked online</div></td>
                        <td class="current"><input type="number" class="editable" id="onlineSched" value="15" oninput="calc()">%</td>
                        <td class="modmed">65%</td>
                        <td class="save" id="onlineSchedSave">$0</td>
                    </tr>
                    <tr>
                        <td><div class="metric-name">Patient Portal Adoption</div><div class="metric-detail">Active users (reduces phone calls)</div></td>
                        <td class="current"><input type="number" class="editable" id="portal" value="20" oninput="calc()">%</td>
                        <td class="modmed">70%</td>
                        <td class="save" id="portalSave">$0</td>
                    </tr>
                    <tr>
                        <td><div class="metric-name">Phone Calls/Day</div><div class="metric-detail">Avg 4 min/call @ staff cost</div></td>
                        <td class="current"><input type="number" class="editable" id="calls" value="65" oninput="calc()"></td>
                        <td class="modmed" id="callsMM">35</td>
                        <td class="save" id="callsSave">$0</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- PATIENT GROWTH -->
        <div class="card compare-section">
            <div class="section-header">
                <h4>üìà Patient Retention & Growth</h4>
                <span class="section-total" id="growthTotal">$0</span>
            </div>
            <table class="compare-table">
                <thead>
                    <tr>
                        <th>Metric</th>
                        <th class="current">Current</th>
                        <th class="modmed">With ModMed</th>
                        <th class="save">Annual Impact</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><div class="metric-name">Patient Retention Rate</div><div class="metric-detail">% returning within 18 months</div></td>
                        <td class="current"><input type="number" class="editable" id="retention" value="72" oninput="calc()">%</td>
                        <td class="modmed">85%</td>
                        <td class="save" id="retentionSave">$0</td>
                    </tr>
                    <tr>
                        <td><div class="metric-name">Review/Referral Rate</div><div class="metric-detail">% who leave reviews or refer</div></td>
                        <td class="current"><input type="number" class="editable" id="referral" value="8" oninput="calc()">%</td>
                        <td class="modmed">18%</td>
                        <td class="save" id="referralSave">$0</td>
                    </tr>
                    <tr>
                        <td><div class="metric-name">Recall Effectiveness</div><div class="metric-detail">% responding to recall campaigns</div></td>
                        <td class="current"><input type="number" class="editable" id="recall" value="25" oninput="calc()">%</td>
                        <td class="modmed">55%</td>
                        <td class="save" id="recallSave">$0</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- OPERATIONS -->
        <div class="card compare-section">
            <div class="section-header">
                <h4>‚öôÔ∏è Operations & Compliance</h4>
                <span class="section-total" id="opsTotal">$0</span>
            </div>
            <table class="compare-table">
                <thead>
                    <tr>
                        <th>Metric</th>
                        <th class="current">Current</th>
                        <th class="modmed">With ModMed</th>
                        <th class="save">Annual Impact</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><div class="metric-name">Check-in/out Time</div><div class="metric-detail">Staff minutes per patient</div></td>
                        <td class="current"><input type="number" class="editable" id="checkin" value="12" oninput="calc()"> min</td>
                        <td class="modmed">4 min</td>
                        <td class="save" id="checkinSave">$0</td>
                    </tr>
                    <tr>
                        <td><div class="metric-name">Staff Overtime</div><div class="metric-detail">Hours/week across all staff</div></td>
                        <td class="current"><input type="number" class="editable" id="overtime" value="8" oninput="calc()"> hrs/wk</td>
                        <td class="modmed">2 hrs/wk</td>
                        <td class="save" id="overtimeSave">$0</td>
                    </tr>
                    <tr>
                        <td><div class="metric-name">MIPS/MACRA Status</div><div class="metric-detail">Current adjustment %</div></td>
                        <td class="current">
                            <select class="editable" id="mips" style="width:auto" onchange="calc()">
                                <option value="-9">-9% penalty</option>
                                <option value="-5">-5% penalty</option>
                                <option value="0" selected>0% neutral</option>
                                <option value="3">+3% bonus</option>
                            </select>
                        </td>
                        <td class="modmed">+5% bonus</td>
                        <td class="save" id="mipsSave">$0</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- INVESTMENT -->
        <div class="card">
            <div class="card-title">üíº ModMed Investment</div>
            <div class="invest-row">
                <div class="invest-item">
                    <div class="invest-label">Per Provider/Mo</div>
                    <input type="number" class="invest-input" id="mmProv" value="700" oninput="calc()">
                </div>
                <div class="invest-item">
                    <div class="invest-label">Per Staff/Mo</div>
                    <input type="number" class="invest-input" id="mmStaff" value="100" oninput="calc()">
                </div>
                <div class="invest-item">
                    <div class="invest-label">Implementation</div>
                    <input type="number" class="invest-input" id="mmImpl" value="15000" oninput="calc()">
                </div>
                <div class="invest-item">
                    <div class="invest-label">Year 1 Total</div>
                    <div class="invest-value" id="mmYear1">$0</div>
                </div>
            </div>
        </div>

        <!-- SUMMARY -->
        <div class="summary-row">
            <div class="summary-card pain">
                <div class="summary-label">üíî Cost of Inaction</div>
                <div class="summary-value" id="totalPain">$0</div>
                <div class="summary-sub">Lost annually</div>
            </div>
            <div class="summary-card save">
                <div class="summary-label">‚ú® Annual Savings</div>
                <div class="summary-value" id="totalSave">$0</div>
                <div class="summary-sub">With ModMed</div>
            </div>
            <div class="summary-card roi">
                <div class="summary-label">üìà Year 1 ROI</div>
                <div class="summary-value" id="roi">0%</div>
                <div class="summary-sub" id="payback">Payback: -- mo</div>
            </div>
            <div class="summary-card net">
                <div class="summary-label">üéØ 3-Year Benefit</div>
                <div class="summary-value" id="net3">$0</div>
                <div class="summary-sub">Net of investment</div>
            </div>
        </div>

        <!-- TALK TRACK -->
        <div class="talk-section">
            <div class="talk-title">üéØ Your Talk Track</div>
            <div class="talk-card">
                <div class="talk-label"><span class="talk-step">1</span>Discovery</div>
                <div class="talk-script">"Walk me through a typical day. Where do you feel like you're <strong>losing time or leaving money on the table</strong>?"</div>
            </div>
            <div class="talk-card">
                <div class="talk-label"><span class="talk-step">2</span>Quantify the Pain</div>
                <div class="talk-script">"Based on what you've shared, the inefficiencies are costing you approximately <strong id="scriptPain">$0</strong> per year. Over 3 years, that's <strong id="scriptPain3">$0</strong>."</div>
            </div>
            <div class="talk-card">
                <div class="talk-label"><span class="talk-step">3</span>The ModMed Difference</div>
                <div class="talk-script">"ModMed practices typically see:<br>
                ‚Ä¢ No-shows drop from <strong id="scriptNoShowFrom">18%</strong> to <strong>8%</strong> with automated reminders<br>
                ‚Ä¢ Collections improve from <strong id="scriptCollFrom">89%</strong> to <strong>95%+</strong><br>
                ‚Ä¢ <strong id="scriptCallReduce">45%</strong> fewer phone calls with patient portal<br>
                That's <strong id="scriptSave">$0</strong> back in your pocket."</div>
            </div>
            <div class="talk-card">
                <div class="talk-label"><span class="talk-step">4</span>Close</div>
                <div class="talk-script">"For <strong id="scriptInvest">$0</strong> in Year 1, you recover <strong id="scriptSave2">$0</strong>‚Äîa <strong id="scriptRoi">0%</strong> return with <strong id="scriptPayback">--</strong> month payback. Three years out? <strong id="scriptNet3">$0</strong> net benefit."</div>
            </div>
        </div>
    </main>

    <script>
        // Realistic presets by practice size and specialty
        const sizes = {
            startup: {providers:1,staff:3,patients:14,overtime:4,calls:30,paCount:6,impl:8000},
            small: {providers:2,staff:6,patients:18,overtime:8,calls:65,paCount:12,impl:15000},
            medium: {providers:5,staff:18,patients:22,overtime:15,calls:120,paCount:30,impl:35000},
            large: {providers:8,staff:32,patients:24,overtime:25,calls:200,paCount:50,impl:60000}
        };
        
        const specialties = {
            plastic: {revenue:425,charting:1.5,denial:12,noShow:18,retention:72,capture:94},
            derm: {revenue:280,charting:1,denial:10,noShow:15,retention:68,capture:95},
            allergy: {revenue:195,charting:1.2,denial:14,noShow:20,retention:75,capture:92},
            ortho: {revenue:520,charting:2,denial:11,noShow:12,retention:65,capture:93}
        };
        
        let currentSize = 'small';
        let currentSpec = 'plastic';
        
        function fmt(n){return n>=1e6?'$'+(n/1e6).toFixed(1)+'M':n>=1e3?'$'+Math.round(n/1e3)+'K':'$'+Math.round(n)}
        function getN(id,d=0){return parseFloat(document.getElementById(id)?.value)||d}
        function setN(id,v){const e=document.getElementById(id);if(e)e.value=v}
        
        function setSize(s){
            currentSize=s;
            document.querySelectorAll('.size-tab').forEach(t=>t.classList.remove('active'));
            document.getElementById('size-'+s).classList.add('active');
            const p=sizes[s];
            setN('providers',p.providers);setN('staff',p.staff);setN('patients',p.patients);
            setN('overtime',p.overtime);setN('calls',p.calls);setN('paCount',p.paCount);setN('mmImpl',p.impl);
            calc();
        }
        
        function setSpecialty(s){
            currentSpec=s;
            document.querySelectorAll('.specialty-btn').forEach(t=>t.classList.remove('active'));
            document.getElementById('spec-'+s).classList.add('active');
            const p=specialties[s];
            setN('revenue',p.revenue);setN('charting',p.charting);setN('denial',p.denial);
            setN('noShow',p.noShow);setN('retention',p.retention);setN('capture',p.capture);
            calc();
        }
        
        function calc(){
            const providers = getN('providers',2);
            const staff = getN('staff',6);
            const patients = getN('patients',18);
            const revenue = getN('revenue',425);
            const ehrType = document.getElementById('ehr').value;
            
            // EHR inefficiency multiplier
            const ehrMult = {paper:1.6,legacy:1.35,generic:1.15,competitor:1.0}[ehrType];
            
            const annualDays = 240;
            const annualVisits = providers * patients * annualDays;
            const annualRevenue = annualVisits * revenue;
            const staffHourly = 28; // Avg loaded cost
            const providerHourly = 200; // Opportunity cost
            
            // === CLINICAL ===
            const charting = getN('charting',1.5);
            const chartingCost = charting * providerHourly * annualDays * providers * ehrMult;
            const chartingSave = chartingCost * 0.65;
            document.getElementById('chartingMM').textContent = (charting * 0.35).toFixed(1) + ' hrs';
            document.getElementById('chartingSave').textContent = fmt(chartingSave);
            
            const paCount = getN('paCount',12);
            const paCost = paCount * 45/60 * staffHourly * 52 * ehrMult;
            const paSave = paCost * 0.55;
            document.getElementById('paMM').textContent = Math.round(paCount * 0.45) + ' /week';
            document.getElementById('paSave').textContent = fmt(paSave);
            
            const chartPrep = getN('chartPrep',8);
            const chartPrepCost = (chartPrep/60) * staffHourly * annualVisits * ehrMult;
            const chartPrepSave = chartPrepCost * 0.6;
            document.getElementById('chartPrepMM').textContent = Math.round(chartPrep * 0.4) + ' min';
            document.getElementById('chartPrepSave').textContent = fmt(chartPrepSave);
            
            const clinicalTotal = chartingSave + paSave + chartPrepSave;
            document.getElementById('clinicalTotal').textContent = fmt(clinicalTotal);
            
            // === REVENUE CYCLE ===
            const denial = getN('denial',12)/100;
            const denialCost = annualVisits * denial * ehrMult * 45; // $45 rework cost
            const denialSave = denialCost * 0.55;
            document.getElementById('denialMM').textContent = Math.round(denial * 100 * 0.45) + '%';
            document.getElementById('denialSave').textContent = fmt(denialSave);
            
            const collection = getN('collection',89)/100;
            const collectionGap = Math.max(0, 0.95 - collection);
            const collectionSave = annualRevenue * collectionGap;
            document.getElementById('collectionSave').textContent = fmt(collectionSave);
            
            const daysAR = getN('daysAR',48);
            const arImprovement = Math.max(0, daysAR - 32);
            const arSave = (annualRevenue / 365) * arImprovement * 0.03; // 3% cost of capital
            document.getElementById('arSave').textContent = fmt(arSave);
            
            const capture = getN('capture',94)/100;
            const captureGap = Math.max(0, 0.99 - capture);
            const captureSave = annualRevenue * captureGap;
            document.getElementById('captureSave').textContent = fmt(captureSave);
            
            const revenueTotal = denialSave + collectionSave + arSave + captureSave;
            document.getElementById('revenueTotal').textContent = fmt(revenueTotal);
            
            // === PATIENT ENGAGEMENT ===
            const noShow = getN('noShow',18)/100;
            const noShowTarget = 0.08;
            const noShowSave = annualVisits * (noShow - noShowTarget) * revenue;
            document.getElementById('noShowMM').textContent = Math.round(noShowTarget * 100) + '%';
            document.getElementById('noShowSave').textContent = fmt(Math.max(0,noShowSave));
            
            const onlineSched = getN('onlineSched',15)/100;
            const onlineTarget = 0.65;
            const schedSave = annualVisits * (onlineTarget - onlineSched) * 8/60 * staffHourly; // 8 min saved per online booking
            document.getElementById('onlineSchedSave').textContent = fmt(Math.max(0,schedSave));
            
            const portal = getN('portal',20)/100;
            const portalTarget = 0.70;
            const calls = getN('calls',65);
            const callReduction = (portalTarget - portal) * 0.6; // 60% of portal adoption reduces calls
            const callsSave = calls * callReduction * 4/60 * staffHourly * annualDays;
            const newCalls = Math.round(calls * (1 - callReduction));
            document.getElementById('callsMM').textContent = newCalls;
            document.getElementById('portalSave').textContent = fmt(Math.max(0,callsSave * 0.4));
            document.getElementById('callsSave').textContent = fmt(Math.max(0,callsSave * 0.6));
            
            const engageTotal = Math.max(0,noShowSave) + Math.max(0,schedSave) + Math.max(0,callsSave);
            document.getElementById('engageTotal').textContent = fmt(engageTotal);
            
            // === PATIENT GROWTH ===
            const retention = getN('retention',72)/100;
            const retentionTarget = 0.85;
            const avgPatientValue = revenue * 3.5; // Avg visits per retained patient per year
            const activePatients = annualVisits / 3.5;
            const retentionSave = activePatients * (retentionTarget - retention) * avgPatientValue;
            document.getElementById('retentionSave').textContent = fmt(Math.max(0,retentionSave));
            
            const referral = getN('referral',8)/100;
            const referralTarget = 0.18;
            const newPatientValue = revenue * 8; // Lifetime value estimate
            const referralSave = activePatients * (referralTarget - referral) * 0.3 * newPatientValue * 0.2; // 30% convert, 20% margin
            document.getElementById('referralSave').textContent = fmt(Math.max(0,referralSave));
            
            const recall = getN('recall',25)/100;
            const recallTarget = 0.55;
            const recallSave = activePatients * 0.3 * (recallTarget - recall) * revenue; // 30% get recalls
            document.getElementById('recallSave').textContent = fmt(Math.max(0,recallSave));
            
            const growthTotal = Math.max(0,retentionSave) + Math.max(0,referralSave) + Math.max(0,recallSave);
            document.getElementById('growthTotal').textContent = fmt(growthTotal);
            
            // === OPERATIONS ===
            const checkin = getN('checkin',12);
            const checkinSave = annualVisits * (checkin - 4)/60 * staffHourly * ehrMult;
            document.getElementById('checkinSave').textContent = fmt(Math.max(0,checkinSave));
            
            const overtime = getN('overtime',8);
            const overtimeSave = (overtime - 2) * 52 * staffHourly * 1.5; // 1.5x overtime rate
            document.getElementById('overtimeSave').textContent = fmt(Math.max(0,overtimeSave));
            
            const mips = parseFloat(document.getElementById('mips').value)/100;
            const mipsTarget = 0.05;
            const mipsSave = annualRevenue * (mipsTarget - mips) * 0.04; // Medicare portion ~4%
            document.getElementById('mipsSave').textContent = fmt(Math.abs(mipsSave));
            
            const opsTotal = Math.max(0,checkinSave) + Math.max(0,overtimeSave) + Math.abs(mipsSave);
            document.getElementById('opsTotal').textContent = fmt(opsTotal);
            
            // === TOTALS ===
            const totalPain = (chartingCost + paCost + chartPrepCost) + 
                             (denialCost + annualRevenue*collectionGap + annualRevenue*captureGap) +
                             (annualVisits*noShow*revenue) + 
                             (activePatients*(1-retention)*avgPatientValue*0.5);
            
            const totalSave = clinicalTotal + revenueTotal + engageTotal + growthTotal + opsTotal;
            
            // Investment
            const mmProv = getN('mmProv',700);
            const mmStaff = getN('mmStaff',100);
            const mmImpl = getN('mmImpl',15000);
            const monthly = (providers * mmProv) + (staff * mmStaff);
            const year1 = (monthly * 12) + mmImpl;
            const ongoing = monthly * 12;
            document.getElementById('mmYear1').textContent = fmt(year1);
            
            const netYear1 = totalSave - year1;
            const netYear3 = netYear1 + ((totalSave - ongoing) * 2);
            const roi = year1 > 0 ? Math.round((netYear1 / year1) * 100) : 0;
            const payback = (totalSave/12) > 0 ? Math.ceil(year1 / (totalSave/12)) : 99;
            
            document.getElementById('totalPain').textContent = fmt(totalPain);
            document.getElementById('totalSave').textContent = fmt(totalSave);
            document.getElementById('roi').textContent = roi + '%';
            document.getElementById('payback').textContent = 'Payback: ' + (payback > 24 ? '24+' : payback) + ' mo';
            document.getElementById('net3').textContent = fmt(netYear3);
            
            // Talk track
            document.getElementById('scriptPain').textContent = fmt(totalPain);
            document.getElementById('scriptPain3').textContent = fmt(totalPain * 3);
            document.getElementById('scriptNoShowFrom').textContent = Math.round(noShow*100) + '%';
            document.getElementById('scriptCollFrom').textContent = Math.round(collection*100) + '%';
            document.getElementById('scriptCallReduce').textContent = Math.round(callReduction*100) + '%';
            document.getElementById('scriptSave').textContent = fmt(totalSave);
            document.getElementById('scriptSave2').textContent = fmt(totalSave);
            document.getElementById('scriptInvest').textContent = fmt(year1);
            document.getElementById('scriptRoi').textContent = roi + '%';
            document.getElementById('scriptPayback').textContent = payback > 24 ? '24+' : payback;
            document.getElementById('scriptNet3').textContent = fmt(netYear3);
            
            window.data = {name:document.getElementById('name').value||'Practice',providers,staff,totalPain,totalSave,year1,netYear1,netYear3,roi,payback,noShow:Math.round(noShow*100),collection:Math.round(collection*100)};
        }
        
        function resetAll(){
            document.getElementById('name').value='';
            setSize('small');
            setSpecialty('plastic');
        }
        
        function copySummary(){
            const d=window.data;
            const txt=`ModMed Value Analysis: ${d.name}
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
${d.providers} Providers | ${d.staff} Staff

Current Pain Points:
‚Ä¢ No-show rate: ${d.noShow}%
‚Ä¢ Collection rate: ${d.collection}%

üíî ANNUAL COST OF INACTION: ${fmt(d.totalPain)}
   (3-Year: ${fmt(d.totalPain*3)})

‚ú® PROJECTED ANNUAL SAVINGS: ${fmt(d.totalSave)}

üíº YEAR 1 INVESTMENT: ${fmt(d.year1)}
üìà YEAR 1 ROI: ${d.roi}%
‚è±Ô∏è PAYBACK: ${d.payback>24?'24+':d.payback} months
üéØ 3-YEAR NET BENEFIT: ${fmt(d.netYear3)}
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ`;
            navigator.clipboard.writeText(txt).then(()=>{
                const btn=document.querySelector('.btn-gold');
                btn.innerHTML='‚úì Copied!';
                setTimeout(()=>btn.innerHTML='üìã Copy',2000);
            });
        }
        
        calc();
    </script>
</body>
</html>
